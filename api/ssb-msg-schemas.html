<html>
    <head>
    <title>SSB-Msg-Schemas - Documentation - SSBC</title>
    <link rel="stylesheet" href="/normalize.css">
    <link rel="stylesheet" href="/styles.css">
    <link rel="stylesheet" href="/monokai.css">
    <script src="/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </head>
    <body>
      <div id="leftnav">
    <div class="leftnav-item ">
      <a href="/patchwork" title="Patchwork">Patchwork<br><small>Messaging App</small></a>
    </div>
    <div class="leftnav-subitems">
      <div class="leftnav-item ">
      <a href="/docs/patchwork/install.html" title="Install">Install</a>
    </div>
      <div class="leftnav-item ">
      <a href="/docs/patchwork/help-faq.html" title="Help / FAQ">Help / FAQ</a>
    </div>
    </div>
    <div class="leftnav-item ">
      <a href="/scuttlebot" title="Scuttlebot">Scuttlebot<br><small>P2P Database</small></a>
    </div>
    <div class="leftnav-subitems">
      <div class="leftnav-item ">
      <a href="/docs/sbot/install.html" title="Install">Install</a>
    </div>
      <div class="leftnav-item ">
      <a href="/docs/sbot/tutorial.html" title="Tutorial">Tutorial</a>
    </div>
      <div class="leftnav-item ">
      <a href="/docs/sbot/howto-setup-a-pub.html" title="HOWTO: Setup a Pub">HOWTO: Setup a Pub</a>
    </div>
    </div>
    <div class="leftnav-item ">
      <a href="/secure-scuttlebutt" title="Secure Scuttlebutt">Secure Scuttlebutt<br><small>Database Protocol</small></a>
    </div>
    <div class="leftnav-subitems">
      <div class="leftnav-item ">
      <a href="/docs/ssb/learn.html" title="Learn about the Protocol">Learn about the Protocol</a>
    </div>
      <div class="leftnav-item ">
      <a href="/docs/ssb/secret-handshake.html" title="Secret Handshake">Secret Handshake</a>
    </div>
      <div class="leftnav-item ">
      <a href="/docs/ssb/end-to-end-encryption.html" title="End-to-end Encryption">End-to-end Encryption</a>
    </div>
    </div>
    <div class="leftnav-item ">
      <a href="/docs/api/index.html" title="API Documentation">API Documentation</a>
    </div>
    <div class="leftnav-subitems">
      <div class="leftnav-item ">
      <a href="/docs/api/scuttlebot.html" title="scuttlebot">scuttlebot</a>
    </div>
      <div class="leftnav-indent">
        <div class="leftnav-item ">
      <a href="/docs/api/scuttlebot-blobs.html" title="blobs">blobs</a>
    </div>
        <div class="leftnav-item ">
      <a href="/docs/api/scuttlebot-block.html" title="block">block</a>
    </div>
        <div class="leftnav-item ">
      <a href="/docs/api/scuttlebot-friends.html" title="friends">friends</a>
    </div>
        <div class="leftnav-item ">
      <a href="/docs/api/scuttlebot-gossip.html" title="gossip">gossip</a>
    </div>
        <div class="leftnav-item ">
      <a href="/docs/api/scuttlebot-invite.html" title="invite">invite</a>
    </div>
        <div class="leftnav-item ">
      <a href="/docs/api/scuttlebot-replicate.html" title="replicate">replicate</a>
    </div>
      </div>
      <div class="leftnav-item ">
      <a href="/docs/api/ssb-msgs.html" title="ssb-msgs">ssb-msgs</a>
    </div>
      <div class="leftnav-item selected">
      <a href="/docs/api/ssb-msg-schemas.html" title="ssb-msg-schemas">ssb-msg-schemas</a>
    </div>
      <div class="leftnav-item ">
      <a href="/docs/api/ssb-ref.html" title="ssb-ref">ssb-ref</a>
    </div>
      <div class="leftnav-item ">
      <a href="/docs/api/ssb-keys.html" title="ssb-keys">ssb-keys</a>
    </div>
      <div class="leftnav-item ">
      <a href="/docs/api/ssb-config.html" title="ssb-config">ssb-config</a>
    </div>
      <div class="leftnav-item ">
      <a href="/docs/api/secret-stack.html" title="secret-stack">secret-stack</a>
    </div>
      <div class="leftnav-item ">
      <a href="/docs/api/muxrpc.html" title="muxrpc">muxrpc</a>
    </div>
      <div class="leftnav-item ">
      <a href="/docs/api/pull-stream.html" title="pull-stream">pull-stream</a>
    </div>
    </div>
    <div class="leftnav-item ">
      <a href="/docs/articles/index.html" title="Articles">Articles</a>
    </div>
    <div class="leftnav-subitems">
      <div class="leftnav-item ">
      <a href="/docs/articles/design-challenge-avoid-centralization-and-singletons.html" title="Design Challenge: Avoiding Centralization and Singletons">Design Challenge: Avoiding Centralization and Singletons</a>
    </div>
      <div class="leftnav-item ">
      <a href="/docs/articles/design-challenge-sybil-attack.html" title="Design Challenge: Sybil Attacks">Design Challenge: Sybil Attacks</a>
    </div>
      <div class="leftnav-item ">
      <a href="/docs/articles/desirable-properties-for-a-secure-channel.html" title="Desirable Properties for a Secure Channel">Desirable Properties for a Secure Channel</a>
    </div>
      <div class="leftnav-item ">
      <a href="/docs/articles/secure-private-channels.html" title="Secure, Private Channels: the Good, the Bad, and the Ugly">Secure, Private Channels: the Good, the Bad, and the Ugly</a>
    </div>
      <div class="leftnav-item ">
      <a href="/docs/articles/using-reputation-in-open-networks.html" title="Using Reputation in Open Networks">Using Reputation in Open Networks</a>
    </div>
    </div>
  </div>
      <div id="content">
        <h1 id="ssb-message-schemas">SSB Message Schemas</h1>
<p>Functions to create common SSB messages.</p>
<pre><code class="lang-js">{ type: &#39;post&#39;, text: String, channel: String, root: MsgLink, branch: MsgLink, recps: FeedLinks, mentions: Links }
{ type: &#39;about&#39;, about: Link, name: String, image: BlobLink }
{ type: &#39;contact&#39;, contact: FeedLink, following: Bool, blocking: Bool }
{ type: &#39;vote&#39;, vote: { link: Ref, value: -1|0|1, reason: String } }
{ type: &#39;pub&#39;, pub: { link: FeedRef, host: String, port: Number } }
</code></pre>
<pre><code class="lang-js">var schemas = require(&#39;ssb-msg-schemas&#39;)

schemas.post(text, root (optional), branch (optional), mentions (optional), recps (optional), channel (optional))
// =&gt; { type: &#39;post&#39;, text: text, channel: channel, root: root, branch: branch, mentions: mentions, recps: recps }
schemas.name(id, name)
// =&gt; { type: &#39;about&#39;, about: id, name: name }
schemas.image(id, imgLink)
// =&gt; { type: &#39;about&#39;, about: id, image: imgLink }
schemas.follow(userId)
// =&gt; { type: &#39;contact&#39;, contact: userId, following: true, blocking: false }
schemas.unfollow(userId)
// =&gt; { type: &#39;contact&#39;, contact: userId, following: false }
schemas.block(userId)
// =&gt; { type: &#39;contact&#39;, contact: userId, following: false, blocking: true }
schemas.unblock(userId)
// =&gt; { type: &#39;contact&#39;, contact: userId, blocking: false }
schemas.vote(id, vote)
// =&gt; { type: &#39;vote&#39;, vote: { link: id, value: vote } }
schemas.vote(id, vote, reason)
// =&gt; { type: &#39;vote&#39;, vote: { link: id, value: vote, reason: reason } }
schemas.pub(id, host, port)
// =&gt; { type: &#39;pub&#39;, pub: { link: id, host: host, port: port } }
</code></pre>
<h2 id="notes">Notes</h2>
<h3 id="type-post">type: post</h3>
<pre><code class="lang-js">{ type: &#39;post&#39;, text: String, channel: String, root: MsgLink, branch: MsgLink, recps: FeedLinks, mentions: Links }
</code></pre>
<ul>
<li><code>channel</code> is optionally used to filter posts into groups, similar to subreddits or chat channels.</li>
<li><code>root</code> and <code>branch</code> are for replies.<ul>
<li><code>root</code> should point to the topmost message in the thread.</li>
<li><code>branch</code> should point to the message in the thread which is being replied to.</li>
<li>In the first reply of a thread, <code>root === branch</code>, and both should be included.</li>
<li><code>root</code> and <code>branch</code> should only point to <code>type: post</code> messages. If the post is about another message-type, use <code>mentions</code>.</li>
</ul>
</li>
<li><code>mentions</code> is a generic reference to other feeds, entities, or blobs.<ul>
<li>It is used by user mentions (you typed &quot;@bob&quot;, so bob&#39;s link goes in <code>mentions</code>).</li>
<li>It is used by file-attachments (you attached a file, the reference goes in <code>mentions</code>).</li>
<li>It is used by message-mentions (to reference non-post messages).</li>
</ul>
</li>
<li><code>recps</code> is a list of user-links specifying who the message is for.<ul>
<li>This is typically used for encrypted messages, to specify who the message was encrypted for.</li>
</ul>
</li>
</ul>
<h3 id="type-about">type: about</h3>
<pre><code class="lang-js">{ type: &#39;about&#39;, about: Link, name: String, image: BlobLink }
</code></pre>
<ul>
<li>You should only include 1 votable piece of information at a time in an about message.<ul>
<li>Of the attributes specified here, <code>name</code> and <code>image</code> are votable.</li>
<li>Therefore, <code>name</code> and <code>image</code> should not appear in the same message.</li>
<li>Reason: vote messages cant differentiate on content within a message. If <code>name</code> and <code>image</code> are grouped together, a vote on the message is a vote on both pieces of information.</li>
</ul>
</li>
<li>Typically, <code>type: about</code> is for users, but it can also be used on msgs and blobs.</li>
</ul>

      </div>
    </body>
  </html>